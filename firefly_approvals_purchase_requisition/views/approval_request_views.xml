<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="customized_approval_request_view_form" model="ir.ui.view">
        <field name="name">customized.approval.request.view.form</field>
        <field name="model">approval.request</field>
        <field name="inherit_id" ref="approvals.approval_request_view_form"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='request_owner_id']" position="attributes">
                <attribute name="attrs">{'required': [('approval_type', '=', 'vendor_bill')]}</attribute>
            </xpath>
            <xpath expr="//field[@name='has_product']" position="after">
                <field name="has_agreement_type" invisible="1"/>
                <field name="has_vendor" invisible="1"/>
                <field name="has_bill_reference" invisible="1"/>
                <field name="has_price" invisible="1"/>
                <field name="has_account" invisible="1"/>
                <field name="has_analytic_account" invisible="1"/>
                <field name="has_analytic_tag" invisible="1"/>
                <field name="has_quality_tag" invisible="1"/>
            </xpath>
            <xpath expr="//field[@name='quantity']" position="before">
                <field name="agreement_type_quantity_copy" invisible="1"/>
                <field name="agreement_type_id" options="{'no_create': True, 'no_create_edit': True}" attrs="{'required': [('has_agreement_type', '=', 'required')], 'readonly': [('request_status', 'not in', ['new', 'pending'])], 'invisible': ['|', ('has_agreement_type', '=', 'no'), ('approval_type', '!=', 'purchase_agreement')]}" force_save="1"/>
                <field name="vendor_id" attrs="{'required': ['|', ('agreement_type_quantity_copy', '=', 'none'), ('has_vendor', '=', 'required')], 'readonly': [('request_status', 'not in', ['new', 'pending'])], 'invisible': ['|', ('has_vendor', '=', 'no'), ('approval_type', 'not in', ['purchase_agreement', 'vendor_bill'])]}" force_save="1"/>
                <field name="bill_reference" attrs="{'required': [('has_bill_reference', '=', 'required')], 'readonly': [('request_status', 'not in', ['new', 'pending'])], 'invisible': ['|', ('has_bill_reference', '=', 'no'), ('approval_type', '!=', 'vendor_bill')]}" force_save="1"/>
                <field name="quality_tag_ids" widget="many2many_tags" options="{'no_create': True, 'no_create_edit': True}" attrs="{'required': [('has_quality_tag', '=', 'required')], 'readonly': [('request_status', 'not in', ['new', 'pending'])], 'invisible': ['|', ('has_quality_tag', '=', 'no'), ('approval_type', '!=', 'purchase')]}" force_save="1"/>
            </xpath>
            <xpath expr="//button[@name='action_open_purchase_orders']" position="after">
                <button name="action_open_purchase_agreement" type="object"
                    class="oe_stat_button" icon="fa-clipboard"
                    attrs="{'invisible': [('purchase_agreement_count', '=', 0)]}">
                    <field name="purchase_agreement_count" string="Purchase Agreement" widget="statinfo"/>
                </button>
            </xpath>
            <xpath expr="//button[@name='action_open_purchase_orders']" position="after">
                <button name="action_open_vendor_bill" type="object"
                    class="oe_stat_button" icon="fa-clipboard"
                    attrs="{'invisible': [('vendor_bill_count', '=', 0)]}">
                    <field name="vendor_bill_count" string="Bills" widget="statinfo"/>
                </button>
            </xpath>
            <xpath expr="//button[@name='action_confirm']" position="after">
                <button name="action_create_purchase_agreement" type="object"
                    groups="purchase.group_purchase_user"
                    string="Create Purchase Agreement" class="btn-primary"
                    data-hotkey="h" attrs="{'invisible': [
                        '|', '|',
                            ('approval_type', '!=', 'purchase_agreement'),
                            ('request_status', '!=', 'approved'),
                            ('purchase_agreement_count', '&gt;', 0)
                    ]}"/>
                <button name="action_create_vendor_bill" type="object"
                    string="Create Bill" class="btn-primary"
                    data-hotkey="h" attrs="{'invisible': [
                        '|', '|',
                            ('approval_type', '!=', 'vendor_bill'),
                            ('request_status', '!=', 'approved'),
                            ('vendor_bill_count', '&gt;', 0)
                    ]}"/>
            </xpath>
        </field>
    </record>
</odoo>
